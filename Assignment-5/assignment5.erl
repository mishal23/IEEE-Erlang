-module (assignment5).
-export ([add/1,subtract/1,multiply/1,divide/1,greaterThanX/1,lessThanX/1,derive/2,integral/4,sum/1]).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%  QUESTION 1  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Part A %
add(X) -> fun(Y) -> X+Y end.
subtract(X) -> fun(Y) -> X-Y end.
multiply(X) -> fun(Y) -> X*Y end.
divide(X) -> fun(Y) -> X/Y end.

% Part B %
greaterThanX(X) -> fun(Y) -> case Y>X of true -> true; false -> false end end.
lessThanX(X) -> fun(Y) -> case Y<X of true -> true; false -> false end end.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%  QUESTION 2  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
derive(F,H) -> fun(X) -> (F(X+H) - F(X))/H end.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%  QUESTION 3  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
integral(A,B,N,F) -> integral(A,B,N,F,0,0).

integral(A,B,N,_,X,Ans) when X>N -> (((B-A)/N)*Ans)/3;
integral(A,B,N,F,X,Ans) when X==0 -> integral(A,B,N,F,X+1,Ans + F(A));
integral(A,B,N,F,X,Ans) when X==N -> integral(A,B,N,F,X+1,Ans + F(A + X*(B-A)/N));
integral(A,B,N,F,X,Ans) when ((X rem 2)==1) -> integral(A,B,N,F,X+1,Ans + (4*F(A + X*(B-A)/N)));
integral(A,B,N,F,X,Ans) when ((X rem 2)==0) -> integral(A,B,N,F,X+1,Ans + (2*F(A + X*(B-A)/N))).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%  QUESTION 4  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%  QUESTION 5  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
sum(L) -> sum(L,0).

sum([],Ans) -> Ans;
sum([H|T],Ans) ->  sum(T,H+Ans).